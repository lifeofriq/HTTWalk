<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Team Fitness Tracker</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <main class="container">
    <h1>üèÉ HTT Steps Tracker</h1>
    <p>Track your daily steps automatically from screenshots!</p>

    <!-- Leaderboard Section -->
    <section class="leaderboard">
      <h2>üèÖ Leaderboard</h2>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>Total Steps</th>
          </tr>
        </thead>
        <tbody>
          {% for name, steps in leaderboard %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ name }}</td>
            <td>{{ steps }}</td>
          </tr>
          {% else %}
          <tr><td colspan="3" style="text-align:center;">No data yet</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </section>

    <!-- Personal Stats Section -->
    <section class="personal">
      <h2>üë£ Personal Stats</h2>
      <form method="get" action="/">
        <label for="user">Select user:</label>
        <select name="user" id="user" onchange="this.form.submit()">
          <option value="">-- Choose name --</option>
          {% for u in users %}
            <option value="{{ u }}" {% if selected_name == u %}selected{% endif %}>{{ u }}</option>
          {% endfor %}
        </select>
      </form>

      {% if selected_name %}
      <h3>{{ selected_name }}'s Records</h3>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Steps</th>
            <th>Screenshot</th>
          </tr>
        </thead>
        <tbody>
          {% for steps, created_at, filename in personal_records %}
          <tr>
            <td>{{ created_at }}</td>
            <td>{{ steps }}</td>
            <td>
              {% if filename %}
                <a href="{{ url_for('static', filename='uploads/' ~ filename) }}" target="_blank">View</a>
              {% else %}
                -
              {% endif %}
            </td>
          </tr>
          {% else %}
          <tr><td colspan="3" style="text-align:center;">No records yet</td></tr>
          {% endfor %}
        </tbody>
      </table>
      {% endif %}
    </section>

    <!-- Upload Button -->
    <p style="text-align:center; margin-top:20px;">
      <button class="btn" onclick="openUploadChoice()">üì§ Upload Screenshot</button>
    </p>
  </main>
      <footer class="site-footer">
          <div class="footer-inner">
            <span>Thariq Putradhafa</span>
            <span class="footer-sep">‚Ä¢</span>
            <span>Kodingiin</span>
          </div>
      </footer>

<div id="uploadModal" class="modal">
  <div class="modal-content">
    <h3>Choose Upload Type</h3>
    <p>Select which app your screenshot is from:</p>
    <button onclick="window.location.href='/upload_1'" class="choice-btn">‚åö Smartband</button>
    <button onclick="window.location.href='/upload_2'" class="choice-btn">üì± Origin Health & Apple Health</button>
    <br><br>
    <button onclick="closeUploadChoice()" class="close-btn">Cancel</button>
  </div>
</div>

      <style>
        .modal {
          display: none;
          position: fixed;
          z-index: 999;
          padding-top: 20%;
          left: 0; top: 0; width: 100%; height: 100%;
          background-color: rgba(0,0,0,0.6);
        }
        .modal-content {
          margin: auto;
          background: white;
          border-radius: 15px;
          padding: 20px;
          text-align: center;
          width: 80%;
          max-width: 350px;
        }
        .choice-btn, .close-btn {
          margin: 8px 0;
          padding: 10px 15px;
          border: none;
          border-radius: 8px;
          background: #007bff;
          color: white;
          cursor: pointer;
          width: 90%;
          font-size: 16px;
        }
        .close-btn {
          background: #999;
        }
      </style>

      <script>
        function openUploadChoice() {
          document.getElementById("uploadModal").style.display = "block";
        }
        function closeUploadChoice() {
          document.getElementById("uploadModal").style.display = "none";
        }
      </script>

</body>
</html>
